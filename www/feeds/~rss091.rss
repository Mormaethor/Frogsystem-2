<?php

include("login.inc.php");
@$db = mysql_connect($host, $user, $pass);
if ($db)
{
    mysql_select_db($data,$db);

    // Allgemeine Config + Infos
    $index = mysql_query("SELECT * FROM fs_global_config", $db);
    $global_config_arr = mysql_fetch_assoc($index);
    
    echo'
        <&#063;xml version="1.0"&#063;>
        <!DOCTYPE rss SYSTEM "http://my.netscape.com/publish/formats/rss-0.91.dtd">
        <rss version="0.91">
        <channel>
        <language>de</language>
        <description>'.htmlspecialchars($global_config_arr[description]).'</description>
        <link>'.$global_config_arr[virtualhost].'</link>
        <title>'.$htmlspecialchars(global_config_arr[title]).'</title>
    ';

    $index = mysql_query("SELECT news_id, news_text, news_title, news_date
                          FROM ".$pref."news ORDER BY news_date DESC LIMIT 8");
     while ($news_arr = mysql_fetch_assoc($index))
     {
     // Item ausgeben
     echo"
     <item>
     <title>".htmlspecialchars($news_arr[news_title])."</title>
     <link>http://drakensang.worldofplayers.net/index.php#$news_arr[news_id]</link>
     <description>Eine News von DSA-Drakensang.de - Bitte lies dir die News direkt auf der Seite durch.</description>
     </item>
     ";
     }

    echo'
        </channel>
        </rss>
    ';
}
else
{
    echo'
        <&#063;xml version="1.0"&#063;>
        <!DOCTYPE rss SYSTEM "http://my.netscape.com/publish/formats/rss-0.91.dtd">
        <rss version="0.91">
        <channel>
        <language>de</language>
        <description>Fehler: Keine Verbindung zur Datenbank</description>
        <link></link>
        <title>Fehler</title>
        </channel>
        </rss>
    ';
}

?>